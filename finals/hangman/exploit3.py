from pwn import *
wordlist = ['awkward', 'bagpipes', 'banjo', 'croquet', 'jazzy',
    'jinx', 'jukebox', 'kayak', 'kiosk', 'memento', 
    'mystify', 'oxygen', 'pajama', 'pixel', 'polka',
    'quad', 'quip', 'rhythmic', 'rogue', 'sphinx',
    'squawk', 'swivel', 'twelfth', 'unzip', 'waxy']
print wordlist.__len__()

r = None
pp = None

WORDSIZE = wordlist.__len__()

def init():
    global r, pp
    # r = remote('167.205.35.176', 31004)
    r = remote('3.1.85.51', 10004)
    # r = process('./hangman')
    pp = process('./random')
    r.sendlineafter(':', 'fwp')

def dead():
    global r, pp
    r.close()
    pp.close()    

def get_rand():
    pp.sendline('')
    return int(pp.recvline()) % 25

def tebak_words():
    global r, pp
    init()
    cnt = 0
    while(cnt < 10001):
        r.sendlineafter('[+] Your choice: ', '1')
        idx = get_rand()
        ans_set = set(wordlist[idx])
        for x in ans_set:
            r.sendline(x)
        r.sendline('')
        r.recvuntil('Your score: ')

        print r.recvline()
        # r.interactive()
        cnt += 1
    r.interactive()


if __name__ == '__main__':
    tebak_words()
